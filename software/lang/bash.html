

<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="">
    
    
      
        <title>Shell Scripting Survival Guide - Jan Matějka</title>
      
    
    
      
        
        
      
      

    
    
    
      
        
        
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
        <link rel="stylesheet" type="text/css" href="../../_static/matejka.css" />
        <link rel="stylesheet" type="text/css" href="../../_static/sphinx_immaterial_theme.07b60405deca57041.min.css" />
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  


  <script id="__analytics">function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-HBSC0RW1T5"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-HBSC0RW1T5",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-HBSC0RW1T5",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script>

  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#introduction" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../index.html" title="Jan Matějka" class="md-header__button md-logo" aria-label="Jan Matějka" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>
    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Jan Matějka
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Shell Scripting Survival Guide
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent=""  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent=""  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../index.html" title="Jan Matějka" class="md-nav__button md-logo" aria-label="Jan Matějka" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>
    </a>
    Jan Matějka
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
  
    <li class="md-nav__item">
      <a href="../../about.html" class="md-nav__link">
        <span class="md-ellipsis">About</span>
      </a>
    </li>
  

    
      
      
      

  
  
  
  
    <li class="md-nav__item">
      <a href="../../links.html" class="md-nav__link">
        <span class="md-ellipsis">Links</span>
      </a>
    </li>
  

    
      
      
      

  
  
  
  
    <li class="md-nav__item">
      <a href="../argv.html" class="md-nav__link">
        <span class="md-ellipsis">The Ultimate Guide to Argv</span>
      </a>
    </li>
  

    
      
      
      

  
  
  
  
    <li class="md-nav__item">
      <a href="gnumake.html" class="md-nav__link">
        <span class="md-ellipsis">GNU Make Coding Guide</span>
      </a>
    </li>
  

    
      
      
      

  
  
  
  
    <li class="md-nav__item">
      <a href="zsh.html" class="md-nav__link">
        <span class="md-ellipsis">Zsh Scripting Guide</span>
      </a>
    </li>
  

    
      
      
      

  
  
    
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          <span class="md-ellipsis">Shell Scripting Survival Guide</span>
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="#" class="md-nav__link md-nav__link--active">
        <span class="md-ellipsis">Shell Scripting Survival Guide</span>
      </a>
      
        

<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span title="software/lang/bash:introduction (reference label)" class="md-ellipsis">Introduction</span>
  </a>
  
    <nav class="md-nav" aria-label="Introduction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#shell-choice" class="md-nav__link">
    <span title="software/lang/bash:shell choice (reference label)" class="md-ellipsis">Shell Choice</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pre-requisite-knowledge" class="md-nav__link">
    <span title="software/lang/bash:pre-requisite knowledge (reference label)" class="md-ellipsis">Pre-<wbr>Requisite Knowledge</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#conventions" class="md-nav__link">
    <span title="software/lang/bash:conventions (reference label)" class="md-ellipsis">Conventions</span>
  </a>
  
    <nav class="md-nav" aria-label="Conventions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#applicability" class="md-nav__link">
    <span title="software/lang/bash:applicability (reference label)" class="md-ellipsis">Applicability</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filesystem-structure" class="md-nav__link">
    <span title="software/lang/bash:filesystem structure (reference label)" class="md-ellipsis">Filesystem Structure</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#terminal-session-examples" class="md-nav__link">
    <span title="software/lang/bash:terminal session examples (reference label)" class="md-ellipsis">Terminal Session Examples</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#manual-pages-section-references" class="md-nav__link">
    <span title="software/lang/bash:manual pages section references (reference label)" class="md-ellipsis">Manual Pages Section References</span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple-techniques" class="md-nav__link">
    <span title="software/lang/bash:simple techniques (reference label)" class="md-ellipsis">Simple Techniques</span>
  </a>
  
    <nav class="md-nav" aria-label="Simple Techniques">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#shebang" class="md-nav__link">
    <span title="software/lang/bash:shebang (reference label)" class="md-ellipsis">Shebang</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#self" class="md-nav__link">
    <span title="software/lang/bash:self (reference label)" class="md-ellipsis">SELF</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#error-message-printing" class="md-nav__link">
    <span title="software/lang/bash:error message printing (reference label)" class="md-ellipsis">Error Message Printing</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#error-induced-exits" class="md-nav__link">
    <span title="software/lang/bash:error induced exits (reference label)" class="md-ellipsis">Error Induced Exits</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#write-programs-not-functions" class="md-nav__link">
    <span title="software/lang/bash:write programs not functions (reference label)" class="md-ellipsis">Write Programs Not Functions</span>
  </a>
  
    <nav class="md-nav" aria-label="Write Programs Not Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#clear-input-output-definition" class="md-nav__link">
    <span title="software/lang/bash:clear input/output definition (reference label)" class="md-ellipsis">Clear Input/Output Definition</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#functionally-almost-equivalent" class="md-nav__link">
    <span title="software/lang/bash:functionally (almost) equivalent (reference label)" class="md-ellipsis">Functionally <wbr>(Almost) Equivalent</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#now-you-have-to-handle-installation" class="md-nav__link">
    <span title="software/lang/bash:now you have to handle installation (reference label)" class="md-ellipsis">Now You Have to Handle Installation</span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#avoid-directory-changes" class="md-nav__link">
    <span title="software/lang/bash:avoid directory changes (reference label)" class="md-ellipsis">Avoid Directory Changes</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#xargs" class="md-nav__link">
    <span title="software/lang/bash:xargs (reference label)" class="md-ellipsis">xargs</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#boolean-values" class="md-nav__link">
    <span title="software/lang/bash:boolean values (reference label)" class="md-ellipsis">Boolean Values</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#null-globs" class="md-nav__link">
    <span title="software/lang/bash:null globs (reference label)" class="md-ellipsis">Null Globs</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sequence-expressions" class="md-nav__link">
    <span title="software/lang/bash:sequence expressions (reference label)" class="md-ellipsis">Sequence Expressions</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-errexit-judiciously" class="md-nav__link">
    <span title="software/lang/bash:use errexit judiciously (reference label)" class="md-ellipsis">Use Errexit Judiciously</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#resource-cleanup" class="md-nav__link">
    <span title="software/lang/bash:resource cleanup (reference label)" class="md-ellipsis">Resource Cleanup</span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#architectural-techniques" class="md-nav__link">
    <span title="software/lang/bash:architectural techniques (reference label)" class="md-ellipsis">Architectural Techniques</span>
  </a>
  
    <nav class="md-nav" aria-label="Architectural Techniques">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prelude" class="md-nav__link">
    <span title="software/lang/bash:prelude (reference label)" class="md-ellipsis">Prelude</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#command-dispatch" class="md-nav__link">
    <span title="software/lang/bash:command dispatch (reference label)" class="md-ellipsis">Command Dispatch</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#argument-parsing" class="md-nav__link">
    <span title="software/lang/bash:argument parsing (reference label)" class="md-ellipsis">Argument Parsing</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#debugging" class="md-nav__link">
    <span title="software/lang/bash:debugging (reference label)" class="md-ellipsis">Debugging</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuration" class="md-nav__link">
    <span title="software/lang/bash:configuration (reference label)" class="md-ellipsis">Configuration</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#installation" class="md-nav__link">
    <span title="software/lang/bash:installation (reference label)" class="md-ellipsis">Installation</span>
  </a>
  
    <nav class="md-nav" aria-label="Installation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#source-structure" class="md-nav__link">
    <span title="software/lang/bash:source structure (reference label)" class="md-ellipsis">Source Structure</span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing" class="md-nav__link">
    <span title="software/lang/bash:testing (reference label)" class="md-ellipsis">Testing</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#documentation" class="md-nav__link">
    <span title="software/lang/bash:documentation (reference label)" class="md-ellipsis">Documentation</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#help-output" class="md-nav__link">
    <span title="software/lang/bash:help output (reference label)" class="md-ellipsis">Help output</span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#code-style" class="md-nav__link">
    <span title="software/lang/bash:code style (reference label)" class="md-ellipsis">Code Style</span>
  </a>
  
    <nav class="md-nav" aria-label="Code Style">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#breaking-long-lines" class="md-nav__link">
    <span title="software/lang/bash:breaking long lines (reference label)" class="md-ellipsis">Breaking long lines</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#path-definitions" class="md-nav__link">
    <span title="software/lang/bash:path definitions (reference label)" class="md-ellipsis">Path Definitions</span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    <span title="software/lang/bash:conclusion (reference label)" class="md-ellipsis">Conclusion</span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#acknowledgements" class="md-nav__link">
    <span title="software/lang/bash:acknowledgements (reference label)" class="md-ellipsis">Acknowledgements</span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backlog" class="md-nav__link">
    <span title="software/lang/bash:backlog (reference label)" class="md-ellipsis">Backlog</span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span title="software/lang/bash:references (reference label)" class="md-ellipsis">References</span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span title="software/lang/bash:introduction (reference label)" class="md-ellipsis">Introduction</span>
  </a>
  
    <nav class="md-nav" aria-label="Introduction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#shell-choice" class="md-nav__link">
    <span title="software/lang/bash:shell choice (reference label)" class="md-ellipsis">Shell Choice</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pre-requisite-knowledge" class="md-nav__link">
    <span title="software/lang/bash:pre-requisite knowledge (reference label)" class="md-ellipsis">Pre-<wbr>Requisite Knowledge</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#conventions" class="md-nav__link">
    <span title="software/lang/bash:conventions (reference label)" class="md-ellipsis">Conventions</span>
  </a>
  
    <nav class="md-nav" aria-label="Conventions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#applicability" class="md-nav__link">
    <span title="software/lang/bash:applicability (reference label)" class="md-ellipsis">Applicability</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filesystem-structure" class="md-nav__link">
    <span title="software/lang/bash:filesystem structure (reference label)" class="md-ellipsis">Filesystem Structure</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#terminal-session-examples" class="md-nav__link">
    <span title="software/lang/bash:terminal session examples (reference label)" class="md-ellipsis">Terminal Session Examples</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#manual-pages-section-references" class="md-nav__link">
    <span title="software/lang/bash:manual pages section references (reference label)" class="md-ellipsis">Manual Pages Section References</span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple-techniques" class="md-nav__link">
    <span title="software/lang/bash:simple techniques (reference label)" class="md-ellipsis">Simple Techniques</span>
  </a>
  
    <nav class="md-nav" aria-label="Simple Techniques">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#shebang" class="md-nav__link">
    <span title="software/lang/bash:shebang (reference label)" class="md-ellipsis">Shebang</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#self" class="md-nav__link">
    <span title="software/lang/bash:self (reference label)" class="md-ellipsis">SELF</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#error-message-printing" class="md-nav__link">
    <span title="software/lang/bash:error message printing (reference label)" class="md-ellipsis">Error Message Printing</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#error-induced-exits" class="md-nav__link">
    <span title="software/lang/bash:error induced exits (reference label)" class="md-ellipsis">Error Induced Exits</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#write-programs-not-functions" class="md-nav__link">
    <span title="software/lang/bash:write programs not functions (reference label)" class="md-ellipsis">Write Programs Not Functions</span>
  </a>
  
    <nav class="md-nav" aria-label="Write Programs Not Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#clear-input-output-definition" class="md-nav__link">
    <span title="software/lang/bash:clear input/output definition (reference label)" class="md-ellipsis">Clear Input/Output Definition</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#functionally-almost-equivalent" class="md-nav__link">
    <span title="software/lang/bash:functionally (almost) equivalent (reference label)" class="md-ellipsis">Functionally <wbr>(Almost) Equivalent</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#now-you-have-to-handle-installation" class="md-nav__link">
    <span title="software/lang/bash:now you have to handle installation (reference label)" class="md-ellipsis">Now You Have to Handle Installation</span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#avoid-directory-changes" class="md-nav__link">
    <span title="software/lang/bash:avoid directory changes (reference label)" class="md-ellipsis">Avoid Directory Changes</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#xargs" class="md-nav__link">
    <span title="software/lang/bash:xargs (reference label)" class="md-ellipsis">xargs</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#boolean-values" class="md-nav__link">
    <span title="software/lang/bash:boolean values (reference label)" class="md-ellipsis">Boolean Values</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#null-globs" class="md-nav__link">
    <span title="software/lang/bash:null globs (reference label)" class="md-ellipsis">Null Globs</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sequence-expressions" class="md-nav__link">
    <span title="software/lang/bash:sequence expressions (reference label)" class="md-ellipsis">Sequence Expressions</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-errexit-judiciously" class="md-nav__link">
    <span title="software/lang/bash:use errexit judiciously (reference label)" class="md-ellipsis">Use Errexit Judiciously</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#resource-cleanup" class="md-nav__link">
    <span title="software/lang/bash:resource cleanup (reference label)" class="md-ellipsis">Resource Cleanup</span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#architectural-techniques" class="md-nav__link">
    <span title="software/lang/bash:architectural techniques (reference label)" class="md-ellipsis">Architectural Techniques</span>
  </a>
  
    <nav class="md-nav" aria-label="Architectural Techniques">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prelude" class="md-nav__link">
    <span title="software/lang/bash:prelude (reference label)" class="md-ellipsis">Prelude</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#command-dispatch" class="md-nav__link">
    <span title="software/lang/bash:command dispatch (reference label)" class="md-ellipsis">Command Dispatch</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#argument-parsing" class="md-nav__link">
    <span title="software/lang/bash:argument parsing (reference label)" class="md-ellipsis">Argument Parsing</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#debugging" class="md-nav__link">
    <span title="software/lang/bash:debugging (reference label)" class="md-ellipsis">Debugging</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuration" class="md-nav__link">
    <span title="software/lang/bash:configuration (reference label)" class="md-ellipsis">Configuration</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#installation" class="md-nav__link">
    <span title="software/lang/bash:installation (reference label)" class="md-ellipsis">Installation</span>
  </a>
  
    <nav class="md-nav" aria-label="Installation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#source-structure" class="md-nav__link">
    <span title="software/lang/bash:source structure (reference label)" class="md-ellipsis">Source Structure</span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing" class="md-nav__link">
    <span title="software/lang/bash:testing (reference label)" class="md-ellipsis">Testing</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#documentation" class="md-nav__link">
    <span title="software/lang/bash:documentation (reference label)" class="md-ellipsis">Documentation</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#help-output" class="md-nav__link">
    <span title="software/lang/bash:help output (reference label)" class="md-ellipsis">Help output</span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#code-style" class="md-nav__link">
    <span title="software/lang/bash:code style (reference label)" class="md-ellipsis">Code Style</span>
  </a>
  
    <nav class="md-nav" aria-label="Code Style">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#breaking-long-lines" class="md-nav__link">
    <span title="software/lang/bash:breaking long lines (reference label)" class="md-ellipsis">Breaking long lines</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#path-definitions" class="md-nav__link">
    <span title="software/lang/bash:path definitions (reference label)" class="md-ellipsis">Path Definitions</span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    <span title="software/lang/bash:conclusion (reference label)" class="md-ellipsis">Conclusion</span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#acknowledgements" class="md-nav__link">
    <span title="software/lang/bash:acknowledgements (reference label)" class="md-ellipsis">Acknowledgements</span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backlog" class="md-nav__link">
    <span title="software/lang/bash:backlog (reference label)" class="md-ellipsis">Backlog</span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span title="software/lang/bash:references (reference label)" class="md-ellipsis">References</span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset" role="main">
                  


<h1 id="shell-scripting-survival-guide"><a class="toc-backref" href="#id70">Shell Scripting Survival Guide</a><a class="headerlink" href="#shell-scripting-survival-guide" title="Permalink to this heading">¶</a></h1>
<p>By <a class="reference external" href="https://matejka.ninja">Jan Matějka</a>, June 04, 2019</p>
<div class="contents topic" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#shell-scripting-survival-guide" id="id70">Shell Scripting Survival Guide</a></p>
<ul>
<li><p><a class="reference internal" href="#introduction" id="id71">Introduction</a></p></li>
<li><p><a class="reference internal" href="#simple-techniques" id="id72">Simple Techniques</a></p></li>
<li><p><a class="reference internal" href="#architectural-techniques" id="id73">Architectural Techniques</a></p></li>
<li><p><a class="reference internal" href="#code-style" id="id74">Code Style</a></p></li>
<li><p><a class="reference internal" href="#conclusion" id="id75">Conclusion</a></p></li>
<li><p><a class="reference internal" href="#acknowledgements" id="id76">Acknowledgements</a></p></li>
<li><p><a class="reference internal" href="#backlog" id="id77">Backlog</a></p></li>
<li><p><a class="reference internal" href="#references" id="id78">References</a></p></li>
</ul>
</li>
</ul>
</div>
<h2 id="introduction"><a class="toc-backref" href="#id71">Introduction</a><a class="headerlink" href="#introduction" title="Permalink to this heading">¶</a></h2>
<p>Shell scripting can be very effective and efficient tool in your toolbox saving you time spent as
exemplified by the famous case of <a class="reference external" href="http://www.leancrew.com/all-this/2011/12/more-shell-less-egg/">most frequently used words problem solved by D. E. Knuth and
M. D. McIlroy</a>.</p>
<p>As much as powerful shell is, it is as much difficult to figure out how to utilize it properly. It
is so difficult, it is not uncommon for programmers to come to the conclusion that shell scripting
is unfeasible for anything but miniscule and elementary scripts. This conclusion inevitably leads to
preferring some general purpose language even when shell scripts would be significantly simpler and
shorter.</p>
<p>This document aims to acquaint you with techniques for shell scripting that empowers to write
readable, succinct, and reliable shell scripts. Suitable for writing CLI prototypes and often even
for the end products.</p>
<h3 id="shell-choice">Shell Choice<a class="headerlink" href="#shell-choice" title="Permalink to this heading">¶</a></h3>
<p>Shell choice is an important first decision you need to make.</p>
<p>If you need your shell script to be portable or acceptable as system component
you are limited to the POSIX shell. Writing POSIX compatible shell scripts is pain but for
non-system programs there are other, superior options.</p>
<p>You might be inclined to just dive into Bash as the de facto standard shell on Linux. However, Bash
is not much of an improvement. Zsh is widely available shell that is, compared to Bash, delightful
to use <a class="footnote-reference brackets" href="#id37" id="id1">2</a>.</p>
<p>Most (all?) of the techniques presented here will be applicable to any POSIX compatible shell but
for practical purposes I will focus on Bash here. Additional techniques specific to Zsh then will be
presented in <a class="reference internal" href="zsh.html"><span class="doc">Zsh Scripting Guide</span></a> but this document is still required reading.</p>
<h3 id="pre-requisite-knowledge">Pre-Requisite Knowledge<a class="headerlink" href="#pre-requisite-knowledge" title="Permalink to this heading">¶</a></h3>
<p>In general only an elementary knowledge of shell scripting is assumed. Some techniques may
require elementary knowledge of related topics:</p>
<ul class="simple">
<li><p>basic scripting (simple commands, flow control, syntax &amp; semantics)</p></li>
<li><p>filesystem model (cwd, pathnames, basic file operations, file descriptors)</p></li>
<li><p><a class="reference external" href="http://www.tldp.org/LDP/Linux-Filesystem-Hierarchy/html/">Linux Filesystem Hierarchy</a></p></li>
<li><p>process model (environment, hierarchy, exit codes, signals <a class="footnote-reference brackets" href="#id55" id="id2">21</a>, fork <a class="footnote-reference brackets" href="#id41" id="id3">6</a> &amp; exec <a class="footnote-reference brackets" href="#id65" id="id4">32</a>)</p></li>
<li><p>important variables like PATH</p></li>
<li><p>manual pages <a class="footnote-reference brackets" href="#id59" id="id5">26</a></p></li>
<li><p>GNU make <a class="footnote-reference brackets" href="#id60" id="id6">27</a></p></li>
</ul>
<p>Deeper knowledge of these topics will also explain the internal working of these techniques and why
some things are the way they are.</p>
<h3 id="conventions">Conventions<a class="headerlink" href="#conventions" title="Permalink to this heading">¶</a></h3>
<h4 id="applicability">Applicability<a class="headerlink" href="#applicability" title="Permalink to this heading">¶</a></h4>
<p>Techniques presented here assume they are to be used on optionally installed software. As opposed to
basic system software, which brings its own unique set of challenges with each system and the
techniques here may or may not be applicable.</p>
<p>To reduce duplication with <a class="reference internal" href="zsh.html"><span class="doc">Zsh Scripting Guide</span></a>, references will include both Bash and Zsh
references and some examples may also show Zsh in addition to Bash examples.</p>
<h4 id="filesystem-structure">Filesystem Structure<a class="headerlink" href="#filesystem-structure" title="Permalink to this heading">¶</a></h4>
<p>Is shown as displayed by <code class="docutils literal notranslate"><span class="pre">tree</span> <span class="pre">-F</span></code> program <a class="footnote-reference brackets" href="#id44" id="id7">9</a>.</p>
<h4 id="terminal-session-examples">Terminal Session Examples<a class="headerlink" href="#terminal-session-examples" title="Permalink to this heading">¶</a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code>$ foo
out
[1]
</code></pre></div>
</div>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">$</span></code></dt><dd><p>indicates a shell prompt. A <code class="docutils literal notranslate"><span class="pre">%</span></code> may be used instead of <code class="docutils literal notranslate"><span class="pre">$</span></code> which implies a non-standard
shell. In this document, <code class="docutils literal notranslate"><span class="pre">%</span></code> implies Zsh.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">foo</span></code></dt><dd><p>execution of command named <code class="docutils literal notranslate"><span class="pre">foo</span></code></p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">out</span></code></dt><dd><p>combined stdout and stderr of the command unless qualified otherwise.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">[1]</span></code></dt><dd><p>foo exited with exit code = <code class="docutils literal notranslate"><span class="pre">1</span></code>.</p>
</dd>
</dl>
<h4 id="manual-pages-section-references">Manual Pages Section References<a class="headerlink" href="#manual-pages-section-references" title="Permalink to this heading">¶</a></h4>
<p>When referring to sections of manual pages, a form like <code class="docutils literal notranslate"><span class="pre">foo</span> <span class="pre">&gt;</span> <span class="pre">bar</span> <span class="pre">in</span> <span class="pre">man</span> <span class="pre">1</span> <span class="pre">tree</span></code> may be used
where <code class="docutils literal notranslate"><span class="pre">foo</span></code> and <code class="docutils literal notranslate"><span class="pre">bar</span></code> are sections with <code class="docutils literal notranslate"><span class="pre">&gt;</span></code> signifying <code class="docutils literal notranslate"><span class="pre">bar</span></code> being hierarchically under
<code class="docutils literal notranslate"><span class="pre">foo</span></code> in manual page for program <code class="docutils literal notranslate"><span class="pre">tree</span></code> listed in manual pages section <code class="docutils literal notranslate"><span class="pre">1</span></code>.</p>
<h2 id="simple-techniques"><a class="toc-backref" href="#id72">Simple Techniques</a><a class="headerlink" href="#simple-techniques" title="Permalink to this heading">¶</a></h2>
<p>This section will deal with techniques that are implementation details, generally applicable
regardless of your code structure.</p>
<h3 id="shebang">Shebang<a class="headerlink" href="#shebang" title="Permalink to this heading">¶</a></h3>
<p>Start your scripts with</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><code><span class="ch">#!/usr/bin/env bash</span>
</code></pre></div>
</div>
<p>To make your scripts executable by <code class="docutils literal notranslate"><span class="pre">./foo-cmd</span></code> instead of a <code class="docutils literal notranslate"><span class="pre">bash</span> <span class="pre">foo-cmd</span></code>, you need to include
a shebang in your script. That’s the <code class="docutils literal notranslate"><span class="pre">#!...</span></code> part.</p>
<p>You want to leverage PATH lookup for portability as different operating systems may install Bash
into different paths. That is the <code class="docutils literal notranslate"><span class="pre">/usr/bin/env</span></code> part <a class="footnote-reference brackets" href="#id61" id="id8">28</a>.</p>
<p>If your target system is linux, or specific set of linuxes, you may get away with <code class="docutils literal notranslate"><span class="pre">#!/bin/bash</span></code> as
Bash is usually system shell or at least considered basic system software. I do not know if this is
universal across all the Linux ecosystem though.</p>
<h3 id="self">SELF<a class="headerlink" href="#self" title="Permalink to this heading">¶</a></h3>
<p>Right after shebang, start your script with SELF definition.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><code><span class="nv">SELF</span><span class="o">=</span><span class="si">${</span><span class="nv">0</span><span class="p">##*/</span><span class="si">}</span>
</code></pre></div>
</div>
<p>SELF is the filename of your executable and will be useful later on at
<a class="reference internal" href="#error-message-printing">Error Message Printing</a>, and <a class="reference internal" href="#prelude">Prelude</a>.</p>
<p>The trick here consist of using zeroth argv element, which is the path to the file being executed
<a class="footnote-reference brackets" href="#id65" id="id9">32</a> and then using parameter expansion <a class="footnote-reference brackets" href="#id67" id="id10">34</a> to get only the base filename.</p>
<p>Note the SELF definition can not be put into a function or <a class="reference internal" href="#prelude">Prelude</a> file as in those places the
<code class="docutils literal notranslate"><span class="pre">$0</span></code> will refer to the sourced file or the function name, respectively.</p>
<h3 id="error-message-printing">Error Message Printing<a class="headerlink" href="#error-message-printing" title="Permalink to this heading">¶</a></h3>
<p>Always lead the message with SELF and write to standard error.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><code><span class="nb">printf</span><span class="w"> </span>&gt;<span class="p">&amp;</span><span class="m">2</span><span class="w"> </span><span class="s2">&quot;%s: %s\n&quot;</span><span class="w"> </span><span class="nv">$SELF</span><span class="w"> </span><span class="s2">&quot;error message&quot;</span>
</code></pre></div>
</div>
<p>Writing to standard error (stderr, that is the <code class="docutils literal notranslate"><span class="pre">&gt;&amp;2</span></code> part <a class="footnote-reference brackets" href="#id62" id="id11">29</a>) allows the user to suppress the
stdandard output (stdout) by redirecting it to /dev/null without suppressing the error output as
even when the user is not interested in the standard output, they will be interested in standard
error if something goes wrong.</p>
<p>Leading with SELF is convention based on the assumption that any program may be used as part of
another script. Then when something goes wrong, the user knows which program is responsible for the
error message.</p>
<h3 id="error-induced-exits">Error Induced Exits<a class="headerlink" href="#error-induced-exits" title="Permalink to this heading">¶</a></h3>
<p>Program termination due to an error must result into non-zero exit code.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><code>foo<span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="nb">printf</span><span class="w"> </span>&gt;<span class="p">&amp;</span><span class="m">2</span><span class="w"> </span><span class="s2">&quot;%s: %s\n&quot;</span><span class="w"> </span><span class="nv">$SELF</span><span class="w"> </span><span class="s2">&quot;foo failed&quot;</span><span class="p">;</span><span class="w"> </span><span class="nb">exit</span><span class="w"> </span><span class="m">1</span><span class="p">;</span><span class="w"> </span><span class="o">}</span>
</code></pre></div>
</div>
<p>Exit code is fundamental way programs signal if something went wrong or everything is ok. You
probably already depended on this behavior, make sure your programs set exit code properly as well.</p>
<h3 id="write-programs-not-functions">Write Programs Not Functions<a class="headerlink" href="#write-programs-not-functions" title="Permalink to this heading">¶</a></h3>
<p>As your script will grow, you will need to structure the script into subroutines. Naturally, your
first instinct may be to use functions but functions are problematic:</p>
<ol class="arabic simple">
<li><p>Functions are difficult to write as their behavior is dependent on shell options and global
variables.</p></li>
<li><p>Functions are difficult to test for the same reasons they are difficult to write.</p></li>
<li><p>Functions complicate <a class="reference internal" href="#errexit">Errexit</a> usage.</p></li>
<li><p>Functions are not usable with <a class="reference internal" href="#xargs">xargs</a> (though there is zargs <a class="footnote-reference brackets" href="#id68" id="id12">35</a> in Zsh)</p></li>
</ol>
<p>Instead you want to write subroutines as standalone programs (processes):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code>/bin/
├── foo
└── foo-subroutine
</code></pre></div>
</div>
<h4 id="clear-input-output-definition">Clear Input/Output Definition<a class="headerlink" href="#clear-input-output-definition" title="Permalink to this heading">¶</a></h4>
<p>By having subroutine a program (process) you have clearly defined inputs:</p>
<ul class="simple">
<li><p>environment</p></li>
<li><p>argv</p></li>
</ul>
<p>and outputs:</p>
<ul class="simple">
<li><p>exit code</p></li>
<li><p>stdout</p></li>
<li><p>stderr</p></li>
</ul>
<p>This is the basic set of things you need to worry about here. Depending on what your program does,
there may be more like stdin, filesystem effects, signals, and maybe more.</p>
<p>That is already plenty of things to worry about. We do not need to add global variables and shell
options to the list.</p>
<h4 id="functionally-almost-equivalent">Functionally (Almost) Equivalent<a class="headerlink" href="#functionally-almost-equivalent" title="Permalink to this heading">¶</a></h4>
<p>Writing subroutine as subprogram will give you all you need from the subroutine and you will use it much
the same way as you would use a function, only simpler as you can run it as any other program.
Sometimes you will need to make a function though. More about that later at <a class="reference internal" href="#prelude">Prelude</a>.</p>
<h4 id="now-you-have-to-handle-installation">Now You Have to Handle Installation<a class="headerlink" href="#now-you-have-to-handle-installation" title="Permalink to this heading">¶</a></h4>
<p>By separating a script into multiple files you may need to worry about installation but with right
tools it is not much of an issue. More about that later at <a class="reference internal" href="#installation">Installation</a>.</p>
<h3 id="avoid-directory-changes">Avoid Directory Changes<a class="headerlink" href="#avoid-directory-changes" title="Permalink to this heading">¶</a></h3>
<p>Most often <code class="docutils literal notranslate"><span class="pre">cd</span></code> is used only to construct a path or other simple things which can be done trivially
by string manipulation or with <code class="docutils literal notranslate"><span class="pre">dirname</span></code> and <code class="docutils literal notranslate"><span class="pre">realpath</span></code> commands.</p>
<p>Code which needlessly changes directories is hard to follow and is prone to breakage on
refactorings.</p>
<p>If you do need to change directories, builtin commands <code class="docutils literal notranslate"><span class="pre">pushd</span></code> and <code class="docutils literal notranslate"><span class="pre">popd</span></code> may be preferred to
<code class="docutils literal notranslate"><span class="pre">cd</span></code> as <code class="docutils literal notranslate"><span class="pre">popd</span></code> also pushes the current working directory onto a stack so you can get back with a
<code class="docutils literal notranslate"><span class="pre">popd</span></code> call.</p>
<p>Other valid strategy is isolating the directory change in a subshell:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><code><span class="k">$(</span><span class="nb">cd</span><span class="w"> </span>foodir<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>cwd-sensitive-command<span class="k">)</span>
</code></pre></div>
</div>
<p>The code withing command substitution (<code class="docutils literal notranslate"><span class="pre">$(</span> <span class="pre">...</span> <span class="pre">)</span></code>) is executed in subshell and directory change
does not effect the surrounding code.</p>
<h3 id="xargs">xargs<a class="headerlink" href="#xargs" title="Permalink to this heading">¶</a></h3>
<p>Prefer xargs <a class="footnote-reference brackets" href="#id46" id="id13">11</a> to for loops or command substitutions <a class="footnote-reference brackets" href="#id69" id="id14">36</a>:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><code>docker<span class="w"> </span>ps<span class="w"> </span>-q<span class="w"> </span><span class="p">|</span><span class="w"> </span>xargs<span class="w"> </span>-r<span class="w"> </span>docker<span class="w"> </span><span class="nb">kill</span>
</code></pre></div>
</div>
<p>It is usually easier to follow once you learn to recognize the pattern as it is more succinct and
removes potential needless state (compared to <code class="docutils literal notranslate"><span class="pre">for</span> <span class="pre">i</span> <span class="pre">in</span> <span class="pre">...</span></code>).</p>
<p>Furthermore, xargs will automatically scale the command argv according
to system limit (compared to <code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">kill</span> <span class="pre">$(docker</span> <span class="pre">ps</span> <span class="pre">-q)</span></code>) and is trivial to parallelize via <code class="docutils literal notranslate"><span class="pre">-P</span>
<span class="pre">$(nproc)</span></code>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">-r</span></code> option prevents running the command on systems with GNU xargs if the input is empty which
is usually the behavior you want.</p>
<h3 id="boolean-values">Boolean Values<a class="headerlink" href="#boolean-values" title="Permalink to this heading">¶</a></h3>
<p>To represent boolean values use <code class="docutils literal notranslate"><span class="pre">true</span></code> and <code class="docutils literal notranslate"><span class="pre">false</span></code></p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><code><span class="nv">foo</span><span class="o">=</span><span class="nb">true</span>

<span class="k">if</span><span class="w"> </span><span class="nv">$foo</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">   </span>...
<span class="k">fi</span>
</code></pre></div>
</div>
<p>The trick here is that both <code class="docutils literal notranslate"><span class="pre">true</span></code> and <code class="docutils literal notranslate"><span class="pre">false</span></code> are either builtins or /bin executables no-ops
with the appropriate exit code <a class="footnote-reference brackets" href="#id63" id="id15">30</a> and the general syntax for <code class="docutils literal notranslate"><span class="pre">if</span></code> keyword is <code class="docutils literal notranslate"><span class="pre">if</span> <span class="pre">&lt;command&gt;;</span>
<span class="pre">then</span></code>.</p>
<p>You probably have typically seen variations like <code class="docutils literal notranslate"><span class="pre">if</span> <span class="pre">[[</span> <span class="pre">...</span> <span class="pre">]];</span></code>  or <code class="docutils literal notranslate"><span class="pre">if</span> <span class="pre">test</span> <span class="pre">-e</span> <span class="pre">...;</span></code> but these
are also just commands and you can use any command possible as the ifs truth value is determined by
the command’s exit code.</p>
<p>However, if you accept these as inputs you need to consider the risk of users injecting malicious
commands depending on your use case.</p>
<p>This convention is motivated entirely by aesthetics and succinctness. What can be usually seen in
the wild is something like:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><code><span class="nv">foo</span><span class="o">=</span>yes

<span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="nv">$foo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;yes&quot;</span><span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">   </span>...
<span class="k">fi</span>
</code></pre></div>
</div>
<h3 id="null-globs">Null Globs<a class="headerlink" href="#null-globs" title="Permalink to this heading">¶</a></h3>
<p>You will probably be globbing a lot. When globbing, you will mostly glob files that can have
<code class="docutils literal notranslate"><span class="pre">1..N</span></code> occurrences. But occasionally you will want to glob a path that may occur <code class="docutils literal notranslate"><span class="pre">0..N</span></code> times.</p>
<p>Globbing a path that does not exist will normally yield an error.</p>
<p>Depending on your shell options, the error may be produced either by the glob itself:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code><span class="o">%</span> <span class="n">printf</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="n">nonexistent</span><span class="o">*</span>
<span class="n">zsh</span><span class="p">:</span> <span class="n">no</span> <span class="n">matches</span> <span class="n">found</span><span class="p">:</span> <span class="n">nonexistent</span><span class="o">*</span>
<span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</code></pre></div>
</div>
<p>or by the commands the glob expands to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code>$ printf &quot;%s\n&quot; nonexistent*
nonexistent*
[0]
</code></pre></div>
</div>
<p>For these occasions, there are null glob options which will make the globs expand to nothing:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code>$ shopt -s nullglob
$ printf &quot;%s&quot; nonexistent*
[0]
</code></pre></div>
</div>
<p>In Zsh:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code><span class="o">%</span> <span class="nb">set</span> <span class="o">-</span><span class="n">G</span>
<span class="o">%</span> <span class="n">printf</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="n">nonexistent</span><span class="o">*</span>
<span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div>
</div>
<p>This is useful in cases where 0 occurrences is valid expansion and the command can handle the null
expansion correctly. As a counterexample, using null glob with cat may be even worse as it may
instead just hang on waiting for input on stdin:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code><span class="o">%</span> <span class="nb">set</span> <span class="o">-</span><span class="n">G</span>
<span class="o">%</span> <span class="n">cat</span> <span class="n">nonexistent</span><span class="o">*</span>
<span class="o">^</span><span class="n">C</span>
<span class="p">[</span><span class="mi">130</span><span class="p">]</span>
</code></pre></div>
</div>
<p>Note, the <code class="docutils literal notranslate"><span class="pre">^C</span></code> here indicates the command has been terminated by Ctrl-C.</p>
<h3 id="sequence-expressions">Sequence Expressions<a class="headerlink" href="#sequence-expressions" title="Permalink to this heading">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code>$ echo {0..5}
0 1 2 3 4 5
</code></pre></div>
</div>
<p>Usable in <code class="docutils literal notranslate"><span class="pre">for</span></code> loops or printfable into <code class="docutils literal notranslate"><span class="pre">xargs</span></code>.</p>
<p>Unfortunately, this works only for a static numbers in bash:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code>$ x=5
$ for i in {0..$x}; do echo $i; done
{0..5}
</code></pre></div>
</div>
<p>But <code class="docutils literal notranslate"><span class="pre">seq</span></code> can be used for the dynamic purpose:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code>$ seq 3
1
2
3
</code></pre></div>
</div>
<h3 id="use-errexit-judiciously"><span id="errexit"></span>Use Errexit Judiciously<a class="headerlink" href="#use-errexit-judiciously" title="Permalink to this heading">¶</a></h3>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><code><span class="nb">set</span><span class="w"> </span>-o<span class="w"> </span>errexit
</code></pre></div>
</div>
<p>Looks like a good idea until you find how broken it is <a class="footnote-reference brackets" href="#id38" id="id16">3</a> <a class="footnote-reference brackets" href="#id39" id="id17">4</a> <a class="footnote-reference brackets" href="#id40" id="id18">5</a> . Generally I recommend to
completely avoid it unless you know very well what you are doing.</p>
<p>We will discuss safe use of errexit later after learning about <code class="docutils literal notranslate"><span class="pre">Architectural</span> <span class="pre">Techniques</span></code>.</p>
<h3 id="resource-cleanup">Resource Cleanup<a class="headerlink" href="#resource-cleanup" title="Permalink to this heading">¶</a></h3>
<p>It is all too common to see shell code like:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><code>acquire-resource

<span class="k">do</span>-things-with-resource

resource-cleanup
</code></pre></div>
</div>
<p>The issue is that script may terminate before it gets to executing the <code class="docutils literal notranslate"><span class="pre">resource-cleanup</span></code>.</p>
<p>You would not do this in general purpose language and you should not in shell as well. General
purpose languages have various ways to deal with the problem such as try…finally construct,
context managers, RAII, defer statements, etc.</p>
<p>In shell, this can be achieved with builtin <code class="docutils literal notranslate"><span class="pre">trap</span></code> command <a class="footnote-reference brackets" href="#id54" id="id19">20</a>:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><code><span class="nb">trap</span><span class="w"> </span><span class="s1">&#39;resource-cleanup&#39;</span><span class="w"> </span>EXIT
acquire-resource

<span class="k">do</span>-things-with-resource
</code></pre></div>
</div>
<p>You can always have only one trap registered so it gets hairy with longer scripts.
But this issue will go away once you apply techniques presented at <a class="reference internal" href="#architectural-techniques">Architectural Techniques</a>.</p>
<h2 id="architectural-techniques"><a class="toc-backref" href="#id73">Architectural Techniques</a><a class="headerlink" href="#architectural-techniques" title="Permalink to this heading">¶</a></h2>
<p>In this section we introduce techniques that impose overall structure on your code and deal with
general topics that almost every program needs to deal with.</p>
<h3 id="prelude">Prelude<a class="headerlink" href="#prelude" title="Permalink to this heading">¶</a></h3>
<p>We already covered you do not want to write functions at <a class="reference internal" href="#write-programs-not-functions">Write Programs Not Functions</a>. But
sometimes you will have to. First thing you may want to do is to have a basic “standard library” for
your script, that is your prelude.</p>
<p>If you do a lot of error handling, you may want to use</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><code>foo<span class="w"> </span><span class="o">||</span><span class="w"> </span>fatal<span class="w"> </span><span class="s2">&quot;foo failed&quot;</span>
</code></pre></div>
</div>
<p>instead of the lengthy error handling from <a class="reference internal" href="#error-induced-exits">Error induced exits</a>.</p>
<p><code class="docutils literal notranslate"><span class="pre">fatal</span></code> has to be a function in order to apply the <code class="docutils literal notranslate"><span class="pre">exit</span> <span class="pre">1</span></code> to the right process.</p>
<p>This is where a prelude file comes in with structure like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code>/bin/
├── foo
├── foo_prelude
└── foo-subroutine
</code></pre></div>
</div>
<p>prelude code:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><code><span class="ch">#!/bin/false</span>

<span class="k">function</span><span class="w"> </span>fatal<span class="w"> </span><span class="o">{</span>
<span class="w">   </span><span class="nb">printf</span><span class="w"> </span>&gt;<span class="p">&amp;</span><span class="m">2</span><span class="w"> </span><span class="s2">&quot;%s: %s&quot;</span><span class="w"> </span><span class="nv">$SELF</span>
<span class="w">   </span><span class="nb">exit</span><span class="w"> </span><span class="m">1</span>
<span class="o">}</span>
</code></pre></div>
</div>
<p>foo code:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><code><span class="ch">#!/usr/bin/env bash</span>

<span class="nv">SELF</span><span class="o">=</span><span class="si">${</span><span class="nv">0</span><span class="p">##*/</span><span class="si">}</span>
.<span class="w"> </span>foo_prelude

foo-subroutine<span class="w"> </span><span class="o">||</span><span class="w"> </span>fatal<span class="w"> </span><span class="s2">&quot;subroutine failed&quot;</span>
</code></pre></div>
</div>
<p>results:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code>$ foo
foo: subroutine failed
[1]
</code></pre></div>
</div>
<p>The trick here, is that you will abuse <code class="docutils literal notranslate"><span class="pre">$PATH</span></code> by adding your prelude in there as well. That will
allow you to do a simple <code class="docutils literal notranslate"><span class="pre">.</span> <span class="pre">foo_prelude</span></code> without worrying where it is actually located.</p>
<p>Since prelude is intended to be sourced, not executed. It is a bit different.
First, it has a special shebang <code class="docutils literal notranslate"><span class="pre">#!/bin/false</span></code> which ensures it will be a
no-op and exit with non-zero exit code if someone tries to execute it. Second, its filename uses
underscore instead of dash. More about that later at <a class="reference internal" href="#command-dispatch">Command Dispatch</a>.</p>
<h3 id="command-dispatch">Command Dispatch<a class="headerlink" href="#command-dispatch" title="Permalink to this heading">¶</a></h3>
<p>Eventually, you will need to add subcommands like <code class="docutils literal notranslate"><span class="pre">foo-cmd1</span></code> to your program:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code>/bin/
├── foo
├── foo_prelude
├── foo_dispatch
├── foo-cmd1
└── foo-cmd2
</code></pre></div>
</div>
<p>foo_dispatch code:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><code><span class="ch">#! /usr/bin/env bash</span>

<span class="nv">SELF</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">0</span><span class="p">##*/</span><span class="si">}</span><span class="s2">&quot;</span>
.<span class="w"> </span>foo_prelude

:<span class="w"> </span><span class="si">${</span><span class="nv">1</span><span class="p">:?</span><span class="si">}</span>
:<span class="w"> </span><span class="si">${</span><span class="nv">2</span><span class="p">:?</span><span class="si">}</span>

<span class="nv">cmd</span><span class="o">=</span><span class="nv">$1</span>-<span class="nv">$2</span>
<span class="nb">shift</span><span class="w"> </span><span class="m">2</span>

<span class="nv">$cmd</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$@</span><span class="s2">&quot;</span>
</code></pre></div>
</div>
<p>foo code:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><code><span class="ch">#! /usr/bin/env bash</span>

<span class="nv">SELF</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">0</span><span class="p">##*/</span><span class="si">}</span><span class="s2">&quot;</span>
.<span class="w"> </span>foo_prelude

foo_dispatch<span class="w"> </span><span class="nv">$SELF</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$@</span><span class="s2">&quot;</span>
</code></pre></div>
</div>
<p>Now we can just add <code class="docutils literal notranslate"><span class="pre">foo-cmd1</span></code> and <code class="docutils literal notranslate"><span class="pre">foo-cmd2</span></code> files and we have subcommands that are executable
as <code class="docutils literal notranslate"><span class="pre">foo</span> <span class="pre">cmd1</span></code> and <code class="docutils literal notranslate"><span class="pre">foo</span> <span class="pre">cmd2</span></code>.</p>
<p>This is very useful as it is generally more user friendly and <code class="docutils literal notranslate"><span class="pre">foo</span></code> executable may perform
initialization like preparing environment variables common for all the subcommands.</p>
<p>Note that prelude and dispatch are named with underscore instead of dash, so these are not
subcommands as <code class="docutils literal notranslate"><span class="pre">foo_dispatch</span></code> constructs the subcommand executables with dashes.</p>
<p>Further note that this construction with <code class="docutils literal notranslate"><span class="pre">SELF</span></code> passing allows <code class="docutils literal notranslate"><span class="pre">foo_dispatch</span></code> to be used to
arbitrary subcommand nesting without any issue.</p>
<p>Even further, if the main entry point is not doing anything special, the next level of dispatch may
be achieved just by symlinking to the main entry point because that will cause <code class="docutils literal notranslate"><span class="pre">SELF</span></code> to be
assigned the name of the symlink and not the actual executable file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code>/bin/
├── foo
├── foo_prelude
├── foo_dispatch
├── foo-cmd1
├── foo-cmd2
├── foo-bar-qux
└── foo-bar -&gt; foo
</code></pre></div>
</div>
<p>Still even further, this approach (which is also used by <code class="docutils literal notranslate"><span class="pre">git</span></code> for example) is that it lends
itself to modularization by 3rd parties by simply dropping <code class="docutils literal notranslate"><span class="pre">foo-3rd</span></code> in your <code class="docutils literal notranslate"><span class="pre">PATH</span></code>.</p>
<h3 id="argument-parsing">Argument Parsing<a class="headerlink" href="#argument-parsing" title="Permalink to this heading">¶</a></h3>
<p>You may forego argument parsing for taking only fixed arguments or environment variables but it will
quickly result into poor user experience until it becomes completely unusable and even user hostile
interface. You will need to do argument parsing.</p>
<p>Your options are <code class="docutils literal notranslate"><span class="pre">getopt</span></code> <a class="footnote-reference brackets" href="#id51" id="id20">17</a> and <code class="docutils literal notranslate"><span class="pre">getopts</span></code> <a class="footnote-reference brackets" href="#id52" id="id21">18</a>. <code class="docutils literal notranslate"><span class="pre">getopts</span></code> is limited to shortopts and
<code class="docutils literal notranslate"><span class="pre">getopt</span></code> may have its own warts. So far I have successfully avoided this problem by using
<code class="docutils literal notranslate"><span class="pre">zparseopts</span></code> <a class="footnote-reference brackets" href="#id53" id="id22">19</a>. You might also be interested in <code class="docutils literal notranslate"><span class="pre">haveopt</span></code> <a class="footnote-reference brackets" href="#id64" id="id23">31</a>. Or you might as well just
write a custom parser. It will not be much different from the way you would write <code class="docutils literal notranslate"><span class="pre">getopts</span></code> usage.</p>
<p>Custom parser would look something like:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><code><span class="ch">#!/usr/bin/env zsh</span>

<span class="nv">SELF</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">0</span><span class="p">##*/</span><span class="si">}</span><span class="s2">&quot;</span>
.<span class="w"> </span>foo_prelude

<span class="c1"># set default values</span>
<span class="nv">o_x</span><span class="o">=</span><span class="nb">false</span>
<span class="nv">o_opt</span><span class="o">=</span>

<span class="c1"># repeat while argv has elements</span>
<span class="k">while</span><span class="w"> </span><span class="o">((</span><span class="w"> </span><span class="nv">$#</span><span class="w"> </span>&gt;<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">))</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">   </span><span class="k">case</span><span class="w"> </span><span class="nv">$1</span><span class="w"> </span><span class="k">in</span>
<span class="w">   </span>-x<span class="o">)</span>
<span class="w">      </span><span class="c1"># parsing a boolean, set the value and</span>
<span class="w">      </span><span class="c1"># consume one element from argv</span>
<span class="w">      </span><span class="nv">o_x</span><span class="o">=</span><span class="nb">true</span>
<span class="w">      </span><span class="nb">shift</span>
<span class="w">      </span><span class="p">;;</span>
<span class="w">   </span>--opt<span class="o">)</span>
<span class="w">      </span><span class="c1"># parsing a parameter option</span>
<span class="w">      </span><span class="c1"># set the value and consume two elements from argv</span>
<span class="w">      </span><span class="nv">o_opt</span><span class="o">=</span><span class="si">${</span><span class="nv">2</span><span class="p">:?Missing --opt value</span><span class="si">}</span>
<span class="w">      </span><span class="nb">shift</span><span class="w"> </span><span class="m">2</span>
<span class="w">      </span><span class="p">;;</span>
<span class="w">   </span>*<span class="o">)</span>
<span class="w">      </span><span class="c1"># parameter not recognized, we either reached</span>
<span class="w">      </span><span class="c1"># positional arguments or user entered invalid</span>
<span class="w">      </span><span class="c1"># flag. Might want to check for &quot;-&quot; prefix or something.</span>
<span class="w">      </span><span class="k">break</span>
<span class="w">      </span><span class="p">;;</span>
<span class="w">   </span><span class="k">esac</span>
<span class="k">done</span>
</code></pre></div>
</div>
<p>The custom parser method adds only one another line per option and the line count is asymptotically
the same with the getopt/getopts approaches. The only real thing you give up, is argument bundling
(<code class="docutils literal notranslate"><span class="pre">-xyz</span></code> being equivalent with <code class="docutils literal notranslate"><span class="pre">-x</span> <span class="pre">-y</span> <span class="pre">-z</span></code>) which can often be sacrificed.</p>
<p>You should really prefer Zsh to Bash anyway. The Zsh solution is a bit more cryptic but much simpler
and discussed in <a class="reference internal" href="zsh.html"><span class="doc">Zsh Scripting Guide</span></a>.</p>
<h3 id="debugging">Debugging<a class="headerlink" href="#debugging" title="Permalink to this heading">¶</a></h3>
<p>The simplest way to debug a script is enabling XTRACE <a class="footnote-reference brackets" href="#id45" id="id24">10</a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code><span class="nb">set</span> <span class="o">-</span><span class="n">x</span>
</code></pre></div>
</div>
<p>We will need to also conveniently propagate it to the subcommands:</p>
<p>foo code:</p>
<div class="highlight-zsh notranslate"><div class="highlight"><pre><span></span><code><span class="ch">#!/usr/bin/env zsh</span>

<span class="nv">SELF</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">0</span><span class="p">##*/</span><span class="si">}</span><span class="s2">&quot;</span>
.<span class="w"> </span>foo_prelude

<span class="k">while</span><span class="w"> </span><span class="o">((</span><span class="w"> </span><span class="nv">$#</span><span class="w"> </span>&gt;<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">))</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">   </span><span class="k">case</span><span class="w"> </span><span class="nv">$1</span><span class="w"> </span><span class="k">in</span>
<span class="w">   </span>-x<span class="o">)</span>
<span class="w">      </span><span class="nb">export</span><span class="w"> </span><span class="nv">FOO_XTRACE</span><span class="o">=</span><span class="nb">true</span>
<span class="w">      </span><span class="nb">shift</span>
<span class="w">      </span><span class="p">;;</span>
<span class="w">   </span>*<span class="o">)</span>
<span class="w">      </span><span class="k">break</span>
<span class="w">      </span><span class="p">;;</span>
<span class="w">   </span><span class="k">esac</span>
<span class="k">done</span>

foo_dispatch<span class="w"> </span><span class="nv">$SELF</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$@</span><span class="s2">&quot;</span>
</code></pre></div>
</div>
<p>prelude code:</p>
<div class="highlight-zsh notranslate"><div class="highlight"><pre><span></span><code><span class="ch">#!/bin/false</span>

<span class="c1"># prelude functions ...</span>

<span class="si">${</span><span class="nv">FOO_XTRACE</span><span class="k">:-</span><span class="nv">false</span><span class="si">}</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">set</span><span class="w"> </span>-x
</code></pre></div>
</div>
<p>Now <code class="docutils literal notranslate"><span class="pre">foo</span> <span class="pre">-x</span></code> will activate xtrace by parsing it from <code class="docutils literal notranslate"><span class="pre">argv</span></code> in the <code class="docutils literal notranslate"><span class="pre">foo</span></code> entrypoint and then
exporting an environment variable <code class="docutils literal notranslate"><span class="pre">FOO_XTRACE=true</span></code>. As the next command will be executing the
prelude, at the end of prelude the <code class="docutils literal notranslate"><span class="pre">FOO_XTRACE</span></code> will evaluate to true and <code class="docutils literal notranslate"><span class="pre">set</span> <span class="pre">-x</span></code>
will enable the xtrace for it.</p>
<p>It is also possible to just export the FOO_XTRACE=true directly instead of using <code class="docutils literal notranslate"><span class="pre">-x</span></code> argument.</p>
<p>Note we are using custom argument parser as demonstrated in <a class="reference internal" href="#argument-parsing">Argument Parsing</a> and <a class="reference internal" href="#boolean-values">Boolean
Values</a> technique for the environment flag.</p>
<p>The xtrace output in bash is not very convenient but it is simple and gets the job done. This will
be more comfortable in <a class="reference internal" href="zsh.html"><span class="doc">Zsh Scripting Guide</span></a>.</p>
<h3 id="configuration">Configuration<a class="headerlink" href="#configuration" title="Permalink to this heading">¶</a></h3>
<p>Just cat files for as long as you can get away with.</p>
<p>Assuming your program is named <code class="docutils literal notranslate"><span class="pre">foo</span></code> and you need a path to <code class="docutils literal notranslate"><span class="pre">bar</span></code> a simple:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><code><span class="nv">bar_path</span><span class="o">=</span><span class="k">$(</span>cat<span class="w"> </span>~/.config/foo/bar_path<span class="k">)</span>
</code></pre></div>
</div>
<p>will do. If you need configurable another option, add another file.</p>
<p>It is easy to read and easy to write. This topic is further discussed at
<a class="reference external" href="http://rants.sigpipe.cz/yaml.html">yaml sucks^Wdoes not rock</a>.</p>
<p>If you will want to use a single configuration file, you will need to structure it and provide a
command like <code class="docutils literal notranslate"><span class="pre">foo-config</span></code> for correctly setting and reading configuration values.</p>
<p>This is the approach <code class="docutils literal notranslate"><span class="pre">git</span></code> takes. The <code class="docutils literal notranslate"><span class="pre">git-config</span></code> is what makes tutorials including commands
like <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">config</span> <span class="pre">--global</span> <span class="pre">user.name</span> <span class="pre">&quot;Jerry</span> <span class="pre">Mouse&quot;</span></code> possible.</p>
<p>Depending on your audience, or other factors, using single structured configuration file may be the
right choice but it is more work and that is non-essential in early stages. Using file per option
lets you focus on the core problem and you can redo configuration once you have something solid.</p>
<p>By using files you will also want to plug <code class="docutils literal notranslate"><span class="pre">envdir</span></code> <a class="footnote-reference brackets" href="#id50" id="id25">16</a> in the main entrypoint and get the
configuration as environment variables for free.</p>
<p>In case you would want to support <code class="docutils literal notranslate"><span class="pre">XDG</span> <span class="pre">Basedir</span> <span class="pre">Spec</span></code> <a class="footnote-reference brackets" href="#id57" id="id26">23</a>, you may additionally plug <code class="docutils literal notranslate"><span class="pre">xdgenv</span></code>
<a class="footnote-reference brackets" href="#id56" id="id27">22</a> into the main entrypoint and have it for free similar to using <code class="docutils literal notranslate"><span class="pre">envdir</span></code>.</p>
<h3 id="installation">Installation<a class="headerlink" href="#installation" title="Permalink to this heading">¶</a></h3>
<p>You want to have a simple, standard way to build and install your program regardless of the size or
number of files of your program. You may get away without it if your program is a single executable
file but as the program grows to multiple files this becomes a necessity.</p>
<p>Use GNU make. Refer to <a class="reference internal" href="gnumake.html"><span class="doc">GNU Make Coding Guide</span></a>.</p>
<h4 id="source-structure">Source Structure<a class="headerlink" href="#source-structure" title="Permalink to this heading">¶</a></h4>
<p>To simplify the installation process and command dispatch we need some conventions for the source
and installation structure.</p>
<p>To recap, this is the structure we install into:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code>/bin/
├── foo
├── foo_prelude
└── foo-subroutine
</code></pre></div>
</div>
<p>Source structure:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code>foo/
└── src/
    ├── foo.bash
    ├── foo_prelude.bash
    └── foo-subroutine.bash
</code></pre></div>
</div>
<h3 id="testing">Testing<a class="headerlink" href="#testing" title="Permalink to this heading">¶</a></h3>
<p>Use <code class="docutils literal notranslate"><span class="pre">cram</span></code> <a class="footnote-reference brackets" href="#id43" id="id28">8</a>. It has issues but it is the best tool for testing command line interfaces I know
of. It is simple to write test cases and interpret failures.</p>
<p>Extend your makefile so tests can be ran with <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">check</span></code>:</p>
<div class="code make highlight-default notranslate"><div class="highlight"><pre><span></span><code>cram_opts ?= --shell=/usr/bin/bash
cram_root ?= cram
cram_path ?= $(cram_root)

check_path = $(pwd)/$(build_dir)/fakeroot/usr/local/bin:/bin:/usr/bin:/usr/local/bin

.PHONY: clean
clean:

        $(RM) -r $(build_dir) $(cram_root)/*.t.err

.PHONY: check
check: build

        mkdir -p $(build_dir)/fakeroot
        DESTDIR=$(build_dir)/fakeroot $(MAKE) install
        env -i PATH=$(check_path) cram $(cram_opts) $(cram_path)
</code></pre></div>
</div>
<ul class="simple">
<li><p>We <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">install</span></code> our code into a fakeroot to make sure if our tests pass, the code was not just
built correctly but installed as well.</p></li>
<li><p>We override the <code class="docutils literal notranslate"><span class="pre">PATH</span></code> variable to make sure we do not rely on non-standard executables.</p></li>
<li><p>We run cram within <code class="docutils literal notranslate"><span class="pre">env</span> <span class="pre">-i</span></code> to ensure the tests does not depend on our custom /
development environment variables.</p></li>
<li><p>And finally we extend <code class="docutils literal notranslate"><span class="pre">clean</span></code> target to cleanup cram artefacts if there are any.</p></li>
<li><p>To fake commands you may simply generate their fake versions into the
<code class="docutils literal notranslate"><span class="pre">$(build_dir)/fakeroot/usr/local/bin</span></code> either by printfing a fake shell script or with
<code class="docutils literal notranslate"><span class="pre">fake</span></code> <a class="footnote-reference brackets" href="#id47" id="id29">12</a></p></li>
</ul>
<h3 id="documentation">Documentation<a class="headerlink" href="#documentation" title="Permalink to this heading">¶</a></h3>
<p>Write man pages. If you are not comfortable with {g,t,n,}roff, you may use man page generators. I
personally use <code class="docutils literal notranslate"><span class="pre">rst2man</span></code> <a class="footnote-reference brackets" href="#id48" id="id30">13</a> as I generally consider <code class="docutils literal notranslate"><span class="pre">reStructuredText</span></code> <a class="footnote-reference brackets" href="#id42" id="id31">7</a> the sweet spot
between power and complexity.</p>
<p>See <a class="reference external" href="http://docutils.sourceforge.net/sandbox/manpage-writer/rst2man.txt">rst2man.txt</a> for an
example man page written rst.</p>
<p>To incorporate documentation, we need to update our source structure:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code>foo
├── Documentation/
│   └── man1/
│       ├── foo-cmd.rst
│       └── foo.rst
└── src/
    ├── foo-cmd.zsh
    ├── foo_dispatch.zsh
    ├── foo_prelude.zsh
    └── foo.zsh
</code></pre></div>
</div>
<p>and makefile:</p>
<div class="code make highlight-default notranslate"><div class="highlight"><pre><span></span><code>## installation targets
i_bin_dir     = $(DESTDIR)$(PREFIX)/bin
i_man_dir     = $(DESTDIR)$(PREFIX)/man/man1

## build targets
b_bin_dir     = $(build_dir)/bin
b_man_dir     = $(build_dir)/man/man1

cmds      = $(patsubst $(src_dir)/%.zsh,%,$(wildcard $(src_dir)/*.zsh))
mans      = $(patsubst Documentation/man1/%.rst,%.1,$(wildcard Documentation/man1/*.rst))

dirs      =
dirs     += $(b_bin_dir) $(i_bin_dir)
dirs     += $(b_man_dir) $(i_man_dir)

## build dependencies
b_deps    =
b_deps   += $(b_bin_dir)
b_deps   += $(b_man_dir)
b_deps   += $(addprefix $(b_bin_dir)/,$(cmds))
b_deps   += $(addprefix $(b_man_dir)/,$(mans))

## install dependencies
i_deps    =
i_deps   += $(i_bin_dir)
i_deps   += $(i_man_dir)
i_deps   += $(addprefix $(i_bin_dir)/,$(cmds))
i_deps   += $(addprefix $(i_man_dir)/,$(mans))


# build man pages
$(b_man_dir)/%.1: Documentation/man1/%.rst

        rst2man $&lt; $@

# install man pages
$(i_man_dir)/%: $(b_man_dir)/%

        $(install_data) $&lt; $@
</code></pre></div>
</div>
<p>Nothing much new is going on here. We just extended</p>
<ul class="simple">
<li><p>the directories we need to build/install with man page directories</p></li>
<li><p>read the manpage files into <code class="docutils literal notranslate"><span class="pre">mans</span></code> variable the same way we do with commands.</p></li>
<li><p>extend build/install dependencies with man pages</p></li>
<li><p>And finally add targets to build and install the man pages.</p></li>
</ul>
<p>This makefile is limited to section 1 man pages but should be trivial to extend
to more sections if needed.</p>
<h3 id="help-output">Help output<a class="headerlink" href="#help-output" title="Permalink to this heading">¶</a></h3>
<p>To support <code class="docutils literal notranslate"><span class="pre">foo</span> <span class="pre">-h</span></code> arguments the simplest solution is to <code class="docutils literal notranslate"><span class="pre">exec</span> <span class="pre">man</span> <span class="pre">foo</span></code> <a class="footnote-reference brackets" href="#id49" id="id32">14</a>.</p>
<h2 id="code-style"><a class="toc-backref" href="#id74">Code Style</a><a class="headerlink" href="#code-style" title="Permalink to this heading">¶</a></h2>
<p>This section deals with techniques that could technically fall under code style but have functional
effects. It will not deal with subjective things like indent length which has no effect on function.</p>
<h3 id="breaking-long-lines">Breaking long lines<a class="headerlink" href="#breaking-long-lines" title="Permalink to this heading">¶</a></h3>
<p>Conditionals can be broken simply after the logical operators without the need for line ending
escape:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><code>foo<span class="w"> </span><span class="o">||</span>
<span class="w">   </span>bar<span class="w"> </span><span class="o">||</span>
<span class="w">   </span>baz
</code></pre></div>
</div>
<p>Argument lists can be broken via a helper array:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><code><span class="nv">args</span><span class="o">=(</span>
<span class="w">   </span>foo
<span class="w">   </span>bar
<span class="o">)</span>

cmd<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">args</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div>
</div>
<p>This has the advantage that</p>
<ul class="simple">
<li><p>you do not need the line ending escape again</p></li>
<li><p>you may experiment with different argument combination simply commenting lines out</p></li>
<li><p>easily extendable on conditionals or passthru options</p></li>
</ul>
<h3 id="path-definitions">Path Definitions<a class="headerlink" href="#path-definitions" title="Permalink to this heading">¶</a></h3>
<p>When writing path literals, get into the habit of not ending with trailing slash. Ever. When
reading file paths, normalize them to not end with trailing slash as well.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code>some_dir=/foo/bar

echo $some_dir/qux
</code></pre></div>
</div>
<p>The main reason is that in some commands the trailing slash implies different semantics. This is the
case with <code class="docutils literal notranslate"><span class="pre">rsync</span></code>, or some instances of <code class="docutils literal notranslate"><span class="pre">cp</span></code>, and probably others.</p>
<p>Secondary reason is that not all paths are file paths and commands using them will not normalize
double slashes into single one. For example abstract unix socket path <code class="docutils literal notranslate"><span class="pre">foo/bar</span></code> and <code class="docutils literal notranslate"><span class="pre">foo//bar</span></code>
refer to different sockets.  URL paths should normalize double slash into single one but that is
handled by the HTTP server <a class="footnote-reference brackets" href="#id36" id="id33">1</a>.</p>
<p>Adherence to “definitions are without trailing slash” makes this a non-issue as each call site may
decide whether it needs to add a slash or not.</p>
<p>Imagine what are your options when having a path defined with trailing slash or possibly either way:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">$some_dir/qux</span></code> looks ok. But you have double slash problem.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">${some_dir}qux</span></code> forces braces. Lacks taste. And now you have to wonder “How exactly is
<code class="docutils literal notranslate"><span class="pre">some_dir</span></code> defined?” each time you want to use its value.</p></li>
</ul>
<h2 id="conclusion"><a class="toc-backref" href="#id75">Conclusion</a><a class="headerlink" href="#conclusion" title="Permalink to this heading">¶</a></h2>
<p>At this point we are mostly done with what can be achieved in POSIX shell or Bash and we got
surprisingly far.</p>
<p>Unfortunately, many solutions are too clunky (as is the case of <a class="reference internal" href="#debugging">Debugging</a>, <a class="reference internal" href="#argument-parsing">Argument Parsing</a>
and more of which has not been discussed yet). It is necessary to pick up a more powerful shell to
continue our quest for readable and succinct code. This quest continues at
<a class="reference internal" href="zsh.html"><span class="doc">Zsh Scripting Guide</span></a> <a class="footnote-reference brackets" href="#id58" id="id34">24</a>.</p>
<h2 id="acknowledgements"><a class="toc-backref" href="#id76">Acknowledgements</a><a class="headerlink" href="#acknowledgements" title="Permalink to this heading">¶</a></h2>
<p>Thanks to <code class="docutils literal notranslate"><span class="pre">Roman</span> <span class="pre">Neuhauser</span></code> <a class="footnote-reference brackets" href="#id66" id="id35">33</a> who I learned much from.</p>
<h2 id="backlog"><a class="toc-backref" href="#id77">Backlog</a><a class="headerlink" href="#backlog" title="Permalink to this heading">¶</a></h2>
<p><a class="reference external" href="https://stackoverflow.com/questions/72889857/why-does-bash-treat-undefined-variables-as-true-in-an-if-statement">https://stackoverflow.com/questions/72889857/why-does-bash-treat-undefined-variables-as-true-in-an-if-statement</a></p>
<p><a class="reference external" href="https://www.vidarholen.net/contents/blog/?p=1035">What exactly was the point of [ “x$var” = “xval” ]?</a></p>
<h2 id="references"><a class="toc-backref" href="#id78">References</a><a class="headerlink" href="#references" title="Permalink to this heading">¶</a></h2>
<dl class="footnote brackets">
<dt class="label" id="id36"><span class="brackets"><a class="fn-backref" href="#id33">1</a></span></dt>
<dd><p>I even think the double slash is not permitted by the HTTP protocol. The normalization may be
courtesy of the server implementors.</p>
</dd>
<dt class="label" id="id37"><span class="brackets"><a class="fn-backref" href="#id1">2</a></span></dt>
<dd><p>Other shells maybe just as fine or even better choice as Zsh but I am not familiar
enough with other shells. Particularly <a class="reference external" href="https://www.skarnet.org/software/execline/">https://www.skarnet.org/software/execline/</a> is
something quite different with interesting properties.</p>
</dd>
<dt class="label" id="id38"><span class="brackets"><a class="fn-backref" href="#id16">3</a></span></dt>
<dd><p><a class="reference external" href="https://mywiki.wooledge.org/BashFAQ/105">https://mywiki.wooledge.org/BashFAQ/105</a></p>
</dd>
<dt class="label" id="id39"><span class="brackets"><a class="fn-backref" href="#id17">4</a></span></dt>
<dd><p>SHELL BUILTIN COMMANDS &gt; set &gt; -e in <code class="docutils literal notranslate"><span class="pre">man</span> <span class="pre">1</span> <span class="pre">bash</span></code></p>
<p>ERR_EXIT in <code class="docutils literal notranslate"><span class="pre">man</span> <span class="pre">1</span> <span class="pre">zshoptions</span></code> <a class="reference external" href="https://linux.die.net/man/1/zshoptions">https://linux.die.net/man/1/zshoptions</a></p>
</dd>
<dt class="label" id="id40"><span class="brackets"><a class="fn-backref" href="#id18">5</a></span></dt>
<dd><p><a class="reference external" href="https://github.com/jan-matejka/errexit-considered-harmful">https://github.com/jan-matejka/errexit-considered-harmful</a></p>
</dd>
<dt class="label" id="id41"><span class="brackets"><a class="fn-backref" href="#id3">6</a></span></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">man</span> <span class="pre">2</span> <span class="pre">fork</span></code> <a class="reference external" href="https://linux.die.net/man/2/fork">https://linux.die.net/man/2/fork</a></p>
</dd>
<dt class="label" id="id42"><span class="brackets"><a class="fn-backref" href="#id31">7</a></span></dt>
<dd><p><a class="reference external" href="http://docutils.sourceforge.net/rst.html">http://docutils.sourceforge.net/rst.html</a></p>
</dd>
<dt class="label" id="id43"><span class="brackets"><a class="fn-backref" href="#id28">8</a></span></dt>
<dd><p><a class="reference external" href="https://github.com/brodie/cram">https://github.com/brodie/cram</a></p>
</dd>
<dt class="label" id="id44"><span class="brackets"><a class="fn-backref" href="#id7">9</a></span></dt>
<dd><p><a class="reference external" href="http://mama.indstate.edu/users/ice/tree/">http://mama.indstate.edu/users/ice/tree/</a></p>
<p><a class="reference external" href="https://linux.die.net/man/1/tree">https://linux.die.net/man/1/tree</a></p>
</dd>
<dt class="label" id="id45"><span class="brackets"><a class="fn-backref" href="#id24">10</a></span></dt>
<dd><p>SHELL BUILTIN COMMANDS &gt; set &gt; -x in <code class="docutils literal notranslate"><span class="pre">man</span> <span class="pre">1</span> <span class="pre">bash</span></code> <a class="reference external" href="https://linux.die.net/man/1/bash">https://linux.die.net/man/1/bash</a></p>
<p>XTRACE in <code class="docutils literal notranslate"><span class="pre">man</span> <span class="pre">1</span> <span class="pre">zshoptions</span></code> <a class="reference external" href="https://linux.die.net/man/1/zshoptions">https://linux.die.net/man/1/zshoptions</a></p>
</dd>
<dt class="label" id="id46"><span class="brackets"><a class="fn-backref" href="#id13">11</a></span></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">man</span> <span class="pre">1</span> <span class="pre">xargs</span></code> <a class="reference external" href="https://linux.die.net/man/1/xargs">https://linux.die.net/man/1/xargs</a></p>
</dd>
<dt class="label" id="id47"><span class="brackets"><a class="fn-backref" href="#id29">12</a></span></dt>
<dd><p><a class="reference external" href="https://github.com/roman-neuhauser/fake">https://github.com/roman-neuhauser/fake</a></p>
</dd>
<dt class="label" id="id48"><span class="brackets"><a class="fn-backref" href="#id30">13</a></span></dt>
<dd><p>python-docutils <a class="reference external" href="http://docutils.sourceforge.net/">http://docutils.sourceforge.net/</a></p>
</dd>
<dt class="label" id="id49"><span class="brackets"><a class="fn-backref" href="#id32">14</a></span></dt>
<dd><p>Also an aproach taken by <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">--help</span></code>. Though git distinguishes short opt (<code class="docutils literal notranslate"><span class="pre">-h</span></code>) and
long opt (<code class="docutils literal notranslate"><span class="pre">--help</span></code>) semantically.</p>
</dd>
<dt class="label" id="id50"><span class="brackets"><a class="fn-backref" href="#id25">16</a></span></dt>
<dd><p><a class="reference external" href="http://cr.yp.to/daemontools/envdir.html">http://cr.yp.to/daemontools/envdir.html</a></p>
<p><a class="reference external" href="http://thedjbway.b0llix.net/daemontools/envdir.html">http://thedjbway.b0llix.net/daemontools/envdir.html</a></p>
</dd>
<dt class="label" id="id51"><span class="brackets"><a class="fn-backref" href="#id20">17</a></span></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">man</span> <span class="pre">1</span> <span class="pre">getopt</span></code> <a class="reference external" href="https://linux.die.net/man/1/getopt">https://linux.die.net/man/1/getopt</a></p>
</dd>
<dt class="label" id="id52"><span class="brackets"><a class="fn-backref" href="#id21">18</a></span></dt>
<dd><p>SHELL BUILTIN COMMANDS &gt; getopts in <code class="docutils literal notranslate"><span class="pre">man</span> <span class="pre">1</span> <span class="pre">bash</span></code> <a class="reference external" href="https://linux.die.net/man/1/bash">https://linux.die.net/man/1/bash</a></p>
</dd>
<dt class="label" id="id53"><span class="brackets"><a class="fn-backref" href="#id22">19</a></span></dt>
<dd><p>THE ZSH/ZUTIL MODULE &gt; zparseopts in <code class="docutils literal notranslate"><span class="pre">man</span> <span class="pre">1</span> <span class="pre">zshmodules</span></code>
<a class="reference external" href="https://linux.die.net/man/1/zshmodules">https://linux.die.net/man/1/zshmodules</a></p>
</dd>
<dt class="label" id="id54"><span class="brackets"><a class="fn-backref" href="#id19">20</a></span></dt>
<dd><p>SHELL BUILTIN COMMANDS &gt; trap in <code class="docutils literal notranslate"><span class="pre">man</span> <span class="pre">1</span> <span class="pre">bash</span></code></p>
<p>SHELL BUILTIN COMMANDS &gt; trap in <code class="docutils literal notranslate"><span class="pre">man</span> <span class="pre">1</span> <span class="pre">zshbuiltins</span></code>
<a class="reference external" href="https://linux.die.net/man/1/zshbuiltins">https://linux.die.net/man/1/zshbuiltins</a></p>
</dd>
<dt class="label" id="id55"><span class="brackets"><a class="fn-backref" href="#id2">21</a></span></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">man</span> <span class="pre">7</span> <span class="pre">signal</span></code> <a class="reference external" href="https://linux.die.net/man/7/signal">https://linux.die.net/man/7/signal</a></p>
</dd>
<dt class="label" id="id56"><span class="brackets"><a class="fn-backref" href="#id27">22</a></span></dt>
<dd><p><a class="reference external" href="https://github.com/jan-matejka/xdgenv">https://github.com/jan-matejka/xdgenv</a></p>
</dd>
<dt class="label" id="id57"><span class="brackets"><a class="fn-backref" href="#id26">23</a></span></dt>
<dd><p><a class="reference external" href="https://specifications.freedesktop.org/basedir-spec/basedir-spec-latest.html">https://specifications.freedesktop.org/basedir-spec/basedir-spec-latest.html</a></p>
</dd>
<dt class="label" id="id58"><span class="brackets"><a class="fn-backref" href="#id34">24</a></span></dt>
<dd><p><a class="reference external" href="https://www.matejka.ninja/software/lang/zsh.html">https://www.matejka.ninja/software/lang/zsh.html</a></p>
</dd>
<dt class="label" id="id59"><span class="brackets"><a class="fn-backref" href="#id5">26</a></span></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">man</span> <span class="pre">1</span> <span class="pre">man</span></code> <a class="reference external" href="https://linux.die.net/man/1/man">https://linux.die.net/man/1/man</a></p>
</dd>
<dt class="label" id="id60"><span class="brackets"><a class="fn-backref" href="#id6">27</a></span></dt>
<dd><p><a class="reference external" href="https://www.gnu.org/software/make/">https://www.gnu.org/software/make/</a></p>
<p><code class="docutils literal notranslate"><span class="pre">man</span> <span class="pre">1</span> <span class="pre">make</span></code> <a class="reference external" href="https://linux.die.net/man/1/make">https://linux.die.net/man/1/make</a></p>
</dd>
<dt class="label" id="id61"><span class="brackets"><a class="fn-backref" href="#id8">28</a></span></dt>
<dd><p>Recently I learned that shebang in the form <code class="docutils literal notranslate"><span class="pre">#!bash</span></code> is also possible I do not know what
additional assumptions (if any) this makes about the target system.</p>
</dd>
<dt class="label" id="id62"><span class="brackets"><a class="fn-backref" href="#id11">29</a></span></dt>
<dd><p>REDIRECTION in <code class="docutils literal notranslate"><span class="pre">man</span> <span class="pre">1</span> <span class="pre">bash</span></code> <a class="reference external" href="https://linux.die.net/man/1/bash">https://linux.die.net/man/1/bash</a></p>
<p>REDIRECTION in <code class="docutils literal notranslate"><span class="pre">man</span> <span class="pre">1</span> <span class="pre">zshmisc</span></code> <a class="reference external" href="https://linux.die.net/man/1/zshmisc">https://linux.die.net/man/1/zshmisc</a></p>
</dd>
<dt class="label" id="id63"><span class="brackets"><a class="fn-backref" href="#id15">30</a></span></dt>
<dd><p>Shell builtins in case of Zsh</p>
</dd>
<dt class="label" id="id64"><span class="brackets"><a class="fn-backref" href="#id23">31</a></span></dt>
<dd><p><a class="reference external" href="https://github.com/roman-neuhauser/haveopt">https://github.com/roman-neuhauser/haveopt</a></p>
</dd>
<dt class="label" id="id65"><span class="brackets">32</span><span class="fn-backref">(<a href="#id4">1</a>,<a href="#id9">2</a>)</span></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">man</span> <span class="pre">3</span> <span class="pre">exec</span></code> <a class="reference external" href="https://linux.die.net/man/3/exec">https://linux.die.net/man/3/exec</a></p>
</dd>
<dt class="label" id="id66"><span class="brackets"><a class="fn-backref" href="#id35">33</a></span></dt>
<dd><p><a class="reference external" href="https://github.com/roman-neuhauser">https://github.com/roman-neuhauser</a></p>
<p><a class="reference external" href="http://rants.sigpipe.cz/">http://rants.sigpipe.cz/</a></p>
</dd>
<dt class="label" id="id67"><span class="brackets"><a class="fn-backref" href="#id10">34</a></span></dt>
<dd><p>EXPANSION &gt; Pameter Expansion in <code class="docutils literal notranslate"><span class="pre">man</span> <span class="pre">1</span> <span class="pre">bash</span></code></p>
</dd>
<dt class="label" id="id68"><span class="brackets"><a class="fn-backref" href="#id12">35</a></span></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">man</span> <span class="pre">1</span> <span class="pre">zshcontrib</span></code> <a class="reference external" href="https://linux.die.net/man/1/zshcontrib">https://linux.die.net/man/1/zshcontrib</a></p>
</dd>
<dt class="label" id="id69"><span class="brackets"><a class="fn-backref" href="#id14">36</a></span></dt>
<dd><p>EXPANSION &gt; Command Substitution in <code class="docutils literal notranslate"><span class="pre">man</span> <span class="pre">1</span> <span class="pre">bash</span></code></p>
</dd>
</dl>



  




                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="zsh.html" class="md-footer__link md-footer__link--prev" aria-label="Previous: Zsh Scripting Guide" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Zsh Scripting Guide
            </div>
          </div>
        </a>
      
      
    </nav>
  
  
  
  <div class="md-footer-meta md-typeset">
    
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-footer-copyright__highlight">
        &#169; Copyright 2022, Jan Matějka.
        
    </div>
  
  
</div>
      
    </div>
    
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
      
        <script src="../../_static/sphinx_immaterial_theme.f9d9eeeb247ace16c.min.js"></script>
    
  </body>
</html>